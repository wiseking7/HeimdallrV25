<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ctrls="clr-namespace:Heimdallr.UI.Controls"
                    xmlns:cnvts="clr-namespace:Heimdallr.UI.Converters">

  <Style TargetType="{x:Type ctrls:HeimdallrPlaceholderPasswordBox}">
    <!-- 기본 속성-->
    <Setter Property="Padding" Value="2"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Foreground" Value="#FF000000"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="CornerRadius" Value="7"/>
    <Setter Property="MouseOverBorderBrush" Value="#FFE7F6F2"/>
    <Setter Property="FocusedBorderBrush" Value="#FF27374D"/>
    <Setter Property="Width" Value="200"/>
    <Setter Property="Height" Value="36"/>
    <Setter Property="FontSize" Value="16"/>
    <Setter Property="Cursor" Value="Hand"/>
    <Setter Property="Validation.ErrorTemplate" Value="{x:Null}"/>
    
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ctrls:HeimdallrPlaceholderPasswordBox}">
          <Border x:Name="border"
                  CornerRadius="7"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  Background="{TemplateBinding Background}" 
                  SnapsToDevicePixels="True"
                  UseLayoutRounding="True">

            <Grid Margin="{TemplateBinding Padding}">
              <Grid.ColumnDefinitions>
                <!-- 아이콘 공간-->
                <ColumnDefinition Width="30"/>

                <!-- 문자열입력 공간-->
                <ColumnDefinition Width="*"/>

                <!-- 눈 아이콘 -->
                <ColumnDefinition Width="35" />
              </Grid.ColumnDefinitions>

              <!-- 좌측 아이콘 -->
              <Viewbox Grid.Column="0"
                       Width="{TemplateBinding IconSize}"  
                       Height="{TemplateBinding IconSize}"  
                       Stretch="Uniform"
                       StretchDirection="Both"
                       VerticalAlignment="Center"
                       HorizontalAlignment="Center">
                <ctrls:HeimdallrIcon Padding="2"
                        Icon="{TemplateBinding Icon}"
                        Fill="{TemplateBinding IconFill}" />
              </Viewbox>

              <!-- 패스워드 입력란 -->
              <PasswordBox x:Name="PART_PasswordBox"
                           Grid.Column="1"
                           Background="Transparent"
                           BorderThickness="0"
                           Foreground="{TemplateBinding Foreground}"
                           CaretBrush="{TemplateBinding CaretBrush}"
                           VerticalAlignment="Center"
                           Visibility="{Binding ShowPassword, RelativeSource={RelativeSource TemplatedParent},
                                         Converter={cnvts:BooleanToVisibilityConverter}, ConverterParameter=invert}"/>

              <!-- 실제 문자열 표시 (보기 모드) -->
              <!-- CaretBrush는 TextBox, PasswordBox 등에서 커서(깜빡이는 막대기)의 색상을 설정하는 속성입니다-->
              <TextBox x:Name="PART_TextBox"
                       Grid.Column="1"
                       Background="Transparent"
                       BorderThickness="0"
                       Foreground="{TemplateBinding Foreground}"
                       CaretBrush="{TemplateBinding CaretBrush}"
                       VerticalAlignment="Center"
                       Visibility="{Binding ShowPassword, RelativeSource={RelativeSource TemplatedParent}, 
                                     Converter={cnvts:BooleanToVisibilityConverter}}" />

              <!-- 입력이 없을때 워터마크 -->
              <TextBlock x:Name="Watermark"
                         Text="{TemplateBinding PlaceholderText}"
                         Foreground="{TemplateBinding PlaceholderForeground}"
                         VerticalAlignment="Center"
                         HorizontalAlignment="Left"
                         Margin="2 0 0 0"
                         IsHitTestVisible="False"
                         Visibility="Collapsed"
                         TextTrimming="CharacterEllipsis"
                         Grid.Column="1"/>

              <!-- 우측 비밀번호 보기 -->
              <Button Grid.Column="2"
                      Width="{TemplateBinding IconSize}"
                      Height="{TemplateBinding IconSize}"
                      Background="Transparent"
                      BorderThickness="0"
                      ToolTip="비밀번호 보기"
                      Command="{x:Static ctrls:HeimdallrPlaceholderPasswordBox.ToggleShowPasswordCommand}"
                      CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}">

                <Button.Style>
                  <Style TargetType="Button">
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="OverridesDefaultStyle" Value="True" />
                    <Setter Property="Template">
                      <Setter.Value>
                        <ControlTemplate TargetType="Button">
                          <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </ControlTemplate>
                      </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                      <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="Transparent" />
                      </Trigger>
                      <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Background" Value="{Binding FocusedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}" />
                      </Trigger>
                    </Style.Triggers>
                  </Style>
                </Button.Style>

                <Viewbox Stretch="Uniform" StretchDirection="Both">
                  <ctrls:HeimdallrIcon Padding="2"
                                       Icon="{TemplateBinding EyeIcon}"
                                       Fill="{TemplateBinding EyeIconFill}" />
                </Viewbox>
              </Button>

            </Grid> 
          </Border>

          <!-- 트리거 정의: 마우스 오버, 포커스, 입력 여부 -->
          <ControlTemplate.Triggers>

            <!-- Validation Error -->
            <Trigger Property="Validation.HasError" Value="True">
              <Setter TargetName="border" Property="BorderBrush" Value="#FFB00020"/>
            </Trigger>

            <!-- 마우스 올리면 BorderBrush 색상 변경 -->
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="border" Property="BorderBrush" 
                      Value="{Binding MouseOverBorderBrush, RelativeSource={RelativeSource TemplatedParent}}"/>
            </Trigger>

            <!-- 키보드 포커스 시 Border 강조 -->
            <Trigger Property="IsKeyboardFocusWithin" Value="True">
              <Setter TargetName="border" Property="BorderBrush" Value="{Binding FocusedBorderBrush, RelativeSource={RelativeSource TemplatedParent}}"/>
              <Setter TargetName="border" Property="BorderThickness" Value="0.5 0.5 0.5 3"/>
            </Trigger>

            <!-- 입력이 없을 때만 워터마크 표시 -->
            <Trigger Property="HasPassword" Value="False">
              <Setter TargetName="Watermark" Property="Visibility" Value="Visible"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</ResourceDictionary>