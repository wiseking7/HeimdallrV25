<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ctrls="clr-namespace:Heimdallr.UI.Controls"
                    xmlns:anim="clr-namespace:Heimdallr.UI.Extensions">

  
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="/Heimdallr.UI;component/Styles/Colors/Color.xaml" />
  </ResourceDictionary.MergedDictionaries>

  <!-- 컨텍스트 메뉴 스타일 -->
  <Style TargetType="{x:Type ctrls:HeimdallrContextMenu}" 
         BasedOn="{StaticResource {x:Type ContextMenu}}">
    <!-- 기본 동작 설정 -->
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="HasDropShadow" Value="True"/>
    <Setter Property="Placement" Value="MousePoint" />
    <Setter Property="FontSize" Value="16" />
    <Setter Property="Foreground" Value="{StaticResource DarkWhite}" />

    <!-- 기본 색상 (애니메이션 대상) -->
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderBrush" Value="Transparent" />
    <Setter Property="BorderThickness" Value="1" />

    <!-- 커스텀 속성 -->
    <Setter Property="CornerRadius" Value="7" />

    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ctrls:HeimdallrContextMenu}">

          <!-- AnimationExtensions 적용 -->
          <Border x:Name="RootBorder"
                  Opacity="0"
                  Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  SnapsToDevicePixels="True"
                  UseLayoutRounding="True"
                  CornerRadius="{TemplateBinding CornerRadius}"
                  
                  anim:AnimationExtensions.AnimatedBackground="{TemplateBinding BackgroundColor}"
                  anim:AnimationExtensions.AnimatedBorderBrush="{TemplateBinding BorderBrush}" >

            <!-- ItemsPresenter는 필수 -->
            <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Cycle"
                            KeyboardNavigation.TabNavigation="Continue"/>
          </Border>

          <ControlTemplate.Triggers>
            <Trigger Property="IsOpen" Value="True">
              <Trigger.EnterActions>
                <BeginStoryboard>
                  <Storyboard>
                    <DoubleAnimation Storyboard.TargetName="RootBorder"
                                   Storyboard.TargetProperty="Opacity"
                                   From="0"
                                   To="1"
                                   Duration="0:0:0.2"/>
                  </Storyboard>
                </BeginStoryboard>
              </Trigger.EnterActions>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <!--#endregion-->
</ResourceDictionary>