<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ctrls="clr-namespace:Heimdallr.UI.Controls"
                    xmlns:cnvts="clr-namespace:Heimdallr.UI.Converters">

  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="/Heimdallr.UI;component/Styles/Colors/Color.xaml" />
  </ResourceDictionary.MergedDictionaries>

  <!--#region HeimdallrMenuItem Style -->
  <Style TargetType="{x:Type ctrls:HeimdallrMenuItem}" BasedOn="{StaticResource {x:Type MenuItem}}">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="Foreground" Value="#FFFFFFFF" />
    <Setter Property="BorderBrush" Value="Transparent" />

    <!-- 커스텀 속성 -->
    <Setter Property="MenuItemPressedBrush" Value="{StaticResource DarkBlueGray}" />
    <Setter Property="MenuItemDisabledForegroundBrush" Value="{StaticResource DarkBurgundyRed}" />
    <Setter Property="MenuItemIsMouseOver" Value="{StaticResource DarkRoyalPurple}" />
    <Setter Property="MenuItemIsMouseOverBrush" Value="{StaticResource DarkYellowOchre}" />
    
    <Setter Property="FontSize" Value="16" />
    <Setter Property="IconSize" Value="30" />
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="CornerRadius" Value="0" />
    <Setter Property="Padding" Value="10,5" />

    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ctrls:HeimdallrMenuItem}">
          <Border x:Name="Border"
                  Opacity="1"
                  CornerRadius="{TemplateBinding CornerRadius}"
                  Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  SnapsToDevicePixels="True"
                  UseLayoutRounding="True">

            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />  <!-- Icon 컬럼 -->
                <ColumnDefinition Width="*" />     <!-- Header 컬럼-->
                <ColumnDefinition Width="Auto" />  <!-- Submenu Indicator 컬럼-->
                <ColumnDefinition Width="*" />     <!-- ShortcutkeyText 컬럼 -->
              </Grid.ColumnDefinitions>

              <!-- Icon (항상 자리 유지) -->
              <ctrls:HeimdallrIcon x:Name="Icon"
                                   Grid.Column="0"
                                   IconSize="20"
                                   Margin="5,10"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"
                                   Fill="{TemplateBinding IconFill}"
                                   Icon="{TemplateBinding Icon}"
                                   Opacity="{Binding Icon,
                                             RelativeSource={RelativeSource TemplatedParent},
                                             Converter={cnvts:IconToOpacityConverter}}" />

              <!-- Header -->
              <ContentPresenter x:Name="HeaderContent"
                                Grid.Column="1"
                                VerticalAlignment="Center"
                                RecognizesAccessKey="True"
                                ContentSource="Header"
                                Margin="10" 
                                TextBlock.Foreground="{TemplateBinding Foreground}"/>


              <!-- SubHeaderText -->
              <TextBlock Grid.Column="3"
                         VerticalAlignment="Center"
                         Margin="10,10"
                         Foreground="{TemplateBinding Foreground}"
                         Text="{TemplateBinding SubHeaderText}"
                         FontSize="14"
                         Opacity="0.7"
                         TextTrimming="CharacterEllipsis"
                         HorizontalAlignment="Right"
                         Visibility="{Binding SubHeaderText, RelativeSource={RelativeSource TemplatedParent}, Converter={cnvts:StringToVisibilityConverter}}" />
            </Grid>
          </Border>

          <ControlTemplate.Triggers>
            <!-- ContextMenu VisualState 연동 -->
            <DataTrigger Value="Normal">
              <DataTrigger.Binding>
                <Binding Path="VisualState"
                         RelativeSource="{RelativeSource AncestorType={x:Type ctrls:HeimdallrContextMenu}}" />
              </DataTrigger.Binding>

              <Setter TargetName="Border" Property="Opacity" Value="1" />
              <Setter TargetName="Border" Property="Background" Value="Transparent" />
              <Setter TargetName="HeaderContent" Property="TextBlock.Foreground" 
                      Value="{Binding Foreground, RelativeSource={RelativeSource TemplatedParent}}"/>
            </DataTrigger>
            <!-- Hover -->
            <DataTrigger Value="Hover">
              <DataTrigger.Binding>
                <Binding Path="VisualState"
                         RelativeSource="{RelativeSource AncestorType={x:Type ctrls:HeimdallrContextMenu}}" />
              </DataTrigger.Binding>

              <Setter TargetName="Border" Property="Background"
                      Value="{Binding MenuItemIsMouseOver, RelativeSource={RelativeSource TemplatedParent}}" />

              <Setter TargetName="HeaderContent"  Property="TextBlock.Foreground"
                      Value="{Binding MenuItemIsMouseOverBrush, RelativeSource={RelativeSource TemplatedParent}}" />
            </DataTrigger>

            <!-- Pressed -->
            <DataTrigger Value="Pressed">
              <DataTrigger.Binding>
                <Binding Path="VisualState"
                         RelativeSource="{RelativeSource AncestorType={x:Type ctrls:HeimdallrContextMenu}}" />
              </DataTrigger.Binding>

              <Setter TargetName="Border" Property="Background"
                      Value="{Binding MenuItemPressedBrush, RelativeSource={RelativeSource TemplatedParent}}" />
            </DataTrigger>

            <!-- Disabled -->
            <DataTrigger Value="Disabled">
              <DataTrigger.Binding>
                <Binding Path="VisualState"
                         RelativeSource="{RelativeSource AncestorType={x:Type ctrls:HeimdallrContextMenu}}" />
              </DataTrigger.Binding>

              <Setter TargetName="HeaderContent" Property="TextBlock.Foreground"
                      Value="{Binding MenuItemDisabledForegroundBrush, RelativeSource={RelativeSource TemplatedParent}}" />
              <Setter TargetName="Border" Property="Opacity" Value="0.5" />
            </DataTrigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <!--#endregion-->
</ResourceDictionary>

