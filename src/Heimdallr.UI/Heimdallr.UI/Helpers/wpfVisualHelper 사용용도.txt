사용 용도
1️⃣ GetOffset (UI 요소 기준점 오프셋 계산)
Vector offset = element1.GetOffset(InterestPoint.Center, element2, InterestPoint.TopLeft, Rect.Empty);


목적: 두 UI 요소 간의 상대적인 위치(거리 벡터)를 계산합니다.

사용 사례:

Custom Popup, Tooltip, Adorner 등을 특정 기준점에 정확히 위치시키고 싶을 때

Canvas, Grid, Relative 위치 계산

InterestPoint를 사용하여 사각형/컨트롤의 TopLeft, Center, BottomRight 등 기준점 지정 가능

2️⃣ GetDpi (Window DPI 확인)
DpiScale2 dpi = mainWindow.GetDpi();
double scaleX = dpi.DpiScaleX;
double scaleY = dpi.DpiScaleY;


목적: 현재 Window의 DPI 배율을 가져와서 픽셀 단위 변환이나 고해상도 DPI 대응에 활용

사용 사례:

고해상도 모니터에서 UI 스케일 조정

Bitmap, Canvas, Drawing 등 렌더링 좌표 계산

애니메이션 또는 커스텀 컨트롤에서 DPI 대응


<Grid Margin="20">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <!-- 기준 버튼 -->
    <Button x:Name="ReferenceButton" Content="기준 버튼" Width="120" Height="40"/>
        
    <!-- Offset 계산 후 위치시킬 버튼 -->
    <Button x:Name="TargetButton" Content="Offset 버튼" Width="120" Height="40"
            Grid.Column="1"/>

    <!-- DPI 표시 텍스트 -->
    <TextBlock x:Name="DpiTextBlock" Grid.Row="1" Margin="0,60,0,0"/>
</Grid>

// DPI 확인
            DpiScale2 dpi = this.GetDpi();
            DpiTextBlock.Text = $"DPI X: {dpi.DpiScaleX:F2}, Y: {dpi.DpiScaleY:F2}";

            // Offset 계산: ReferenceButton Center → TargetButton TopLeft
            Vector offset = ReferenceButton.GetOffset(
                InterestPoint.Center,
                TargetButton,
                InterestPoint.TopLeft,
                Rect.Empty);

            // Offset 적용 (Canvas.Left, Canvas.Top 또는 Margin 조정)
            TargetButton.Margin = new Thickness(
                ReferenceButton.Margin.Left + offset.X,
                ReferenceButton.Margin.Top + offset.Y,
                0, 0);

            // DependencyProperty 헬퍼 사용 예
            bool hasLocalWidth = TargetButton.HasLocalValue(Button.WidthProperty);
            MessageBox.Show($"TargetButton Width has local value? {hasLocalWidth}");